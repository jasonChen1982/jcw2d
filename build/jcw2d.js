!function(t,i){"object"==typeof exports?module.exports=i():"function"==typeof define&&define.amd?define(function(){return t.JC=i()}):t.JC=i()}(this,function(){function t(t){return Object.prototype.toString.call(t)}function i(){this.global={x:-1e5,y:-1e5},this.target=null,this.originalEvent=null,this.cancleBubble=!1,this.ratio=1,this.type=""}function e(){this.touchstarted=!1,this.mouseDowned=!1,this.listeners={}}function s(t){this.element=t.element||{},this.duration=t.duration||300,this.living=!0,this.onCompelete=t.onCompelete||null,this.onUpdate=t.onUpdate||null,this.infinity=t.infinity||!1,this.alternate=t.alternate||!1,this.ease=t.ease||"easeBoth",this.repeats=t.repeats||0,this.delay=t.delay||0,this.progress=0-this.delay,this.timeScale=t.timeScale||1,this.paused=!1}function n(t){x.Animate.call(this,t),this.ATRS=t.from,this.ATRE=t.to}function o(t){x.Animate.call(this,t),this._keyframes=t.keys,this._keyIndex=0,this._direction=1,this._keyConfig=t.keyConfig,this.configKey()}function r(t,i){this.element=t,this.living=!1,this.onCompelete=null,this.infinity=!1,this.alternate=!1,this.repeats=0,this.animations=i.animations||{},this.index=0,this.direction=1,this.frames=[],this.sy=i.sy||0,this.sx=i.sx||0,this.fillMode=0,this.fps=16,this.paused=!1,this.pt=0,this.nt=0}function h(t){x.Animate.call(this,t),this.points=t.points,this.attachNormal=t.attachNormal||!1,this.sDeg=!1,this.tDeg=0,this.pDeg=0}function a(){this.start=!1,this.animates=[]}function p(t,i){this.x=t||0,this.y=i||0}function c(){this.a=1,this.b=0,this.c=0,this.d=1,this.tx=0,this.ty=0}function u(t,i){x.Eventer.call(this),this.width=100,this.height=100,this.realWidth=100,this.realHeight=100,this.scaleMode=i||CONST.SCALE_MODES.DEFAULT,this.hasLoaded=!1,this.isLoading=!1,this.source=null,this.resolution=1,this.premultipliedAlpha=!0,this.imageUrl=null,this.isPowerOfTwo=!1,this.mipmap=!1,t&&this.loadSource(t)}function d(t,i){x.Eventer.call(this),this.noFrame=!1,i||(this.noFrame=!0,i=new math.Rectangle(0,0,1,1)),t instanceof d&&(t=t.baseTexture),this.baseTexture=t,this._frame=i,this.valid=!1,this.requiresUpdate=!1,this._uvs=null,this.width=0,this.height=0,t.hasLoaded?(this.noFrame&&(i=new math.Rectangle(0,0,t.width,t.height),t.on("update",this.onBaseTextureUpdated,this)),this.frame=i):t.once("loaded",this.onBaseTextureLoaded,this)}function l(){this.x0=0,this.y0=0,this.x1=1,this.y1=0,this.x2=1,this.y2=1,this.x3=0,this.y3=1}function f(){this._ready=!0,this.visible=!0,this.worldAlpha=1,this.alpha=1,this.scaleX=1,this.scaleY=1,this.skewX=0,this.skewY=0,this.rotation=0,this.rotationCache=0,this._sr=0,this._cr=1,this.x=0,this.y=0,this.pivotX=0,this.pivotY=0,this.mask=null,this.parent=null,this.worldTransform=new x.Matrix,this.event=new x.Eventer,this.passEvent=!1,this.bound=[],this.Animator=new x.Animator}function y(){x.DisplayObject.call(this),this.cds=[],this.timeScale=1,this.paused=!1}function m(t){x.Container.call(this),this.anchor=new x.Point,this._texture=null,this._width=0,this._height=0,this.tint=16777215,this.blendMode=x.CONST.BLEND_MODES.NORMAL,this.shader=null,this.cachedTint=16777215,this.texture=t}function g(t,i,e){x.Container.call(this),e=e||15e3,t=t||15e3;var s=16384;e>s&&(e=s),e>t&&(e=t),this._properties=[!1,!0,!1,!1,!1],this._maxSize=t,this._batchSize=e,this._buffers=null,this._bufferToUpdate=0,this.interactiveChildren=!1,this.blendMode=x.CONST.BLEND_MODES.NORMAL,this.setProperties(i)}var x=window.JC||{};return function(){for(var t=0,i=/(?=.*?uc)(?=.*?android)/i.test(window.navigator.userAgent),e=["ms","moz","webkit","o"],s=0;s<e.length&&!window.requestAnimationFrame;++s)window.requestAnimationFrame=window[e[s]+"RequestAnimationFrame"],window.cancelAnimationFrame=window[e[s]+"CancelAnimationFrame"]||window[e[s]+"CancelRequestAnimationFrame"];window.requestAnimationFrame&&!i||(window.requestAnimationFrame=function(i){var e=(new Date).getTime(),s=Math.max(0,20-(e-t)),n=window.setTimeout(function(){i(e+s)},s);return t=e+s,n}),window.cancelAnimationFrame||(window.cancelAnimationFrame=function(t){clearTimeout(t)}),window.RAF=window.requestAnimFrame=window.requestAnimationFrame}(),x.CONST={VERSION:"0.0.1",PI_2:2*Math.PI,RTD:180/Math.PI,DTR:Math.PI/180,BLEND_MODES:{NORMAL:0,ADD:1,MULTIPLY:2,SCREEN:3},DRAW_MODES:{POINTS:0,LINES:1,LINE_LOOP:2,LINE_STRIP:3,TRIANGLES:4,TRIANGLE_STRIP:5,TRIANGLE_FAN:6},SCALE_MODES:{DEFAULT:0,LINEAR:0,NEAREST:1},DEFAULT_RENDER_OPTIONS:{view:null,resolution:1,antialias:!1,autoResize:!1,transparent:!1,backgroundColor:0,clearBeforeRender:!0,preserveDrawingBuffer:!1},SPRITE_BATCH_SIZE:2e3},x.UTILS={hex2rgb:function(t,i){return i=i||[],i[0]=(t>>16&255)/255,i[1]=(t>>8&255)/255,i[2]=(255&t)/255,i},hex2string:function(t){return t=t.toString(16),t="000000".substr(0,6-t.length)+t,"#"+t},rgb2hex:function(t){return(255*t[0]<<16)+(255*t[1]<<8)+255*t[2]},getNextPowerOfTwo:function(t){if(t>0&&0===(t&t-1))return t;for(var i=1;i<t;)i<<=1;return i},isPowerOfTwo:function(t,i){return t>0&&0===(t&t-1)&&i>0&&0===(i&i-1)},sayHi:function(t){if(!this._saidHi){if(navigator.userAgent.toLowerCase().indexOf("chrome")>-1){var i=["\n %c %c %c jcw2d.js "+x.CONST.VERSION+" - ✰ "+t+" ✰  %c  %c  http://www.jason82.com/  %c %c ♥%c♥%c♥ \n\n","background: #ff66a5; padding:5px 0;","background: #ff66a5; padding:5px 0;","color: #ff66a5; background: #030307; padding:5px 0;","background: #ff66a5; padding:5px 0;","background: #ffc3dc; padding:5px 0;","background: #ff66a5; padding:5px 0;","color: #ff2424; background: #fff; padding:5px 0;","color: #ff2424; background: #fff; padding:5px 0;","color: #ff2424; background: #fff; padding:5px 0;"];window.console.log.apply(console,i)}else window.console&&window.console.log("jcw2d.js "+x.CONST.VERSION+" - "+t+" - http://www.jason82.com/");this._saidHi=!0}},isWebGLSupported:function(){var t={stencil:!0};try{if(!window.WebGLRenderingContext)return!1;var i=document.createElement("canvas"),e=i.getContext("webgl",t)||i.getContext("experimental-webgl",t);return!(!e||!e.getContextAttributes().stencil)}catch(s){return!1}},sign:function(t){return t?t<0?-1:1:0},removeItems:function(t,i,e){var s=t.length;if(!(i>=s||0===e)){e=i+e>s?s-i:e;for(var n=i,o=s-e;n<o;++n)t[n]=t[n+e];t.length=o}},copyJSON:function(t){return JSON.parse(JSON.stringify(t))},isArray:function(){var i=t("s");return function(t){return Object.prototype.toString.call(t)===i}}(),isObject:function(){var i=t({});return function(t){return Object.prototype.toString.call(t)===i}}(),isNumber:function(){var i=t(1);return function(t){return Object.prototype.toString.call(t)===i}}(),isFunction:function(){var i=t(function(){});return function(t){return Object.prototype.toString.call(t)===i}}(),random:function(t,i){return this.isArray(t)?t[~~(Math.random()*t.length)]:(this.isNumber(i)||(i=t||1,t=0),t+Math.random()*(i-t))},euclideanModulo:function(t,i){return(t%i+i)%i},clamp:function(t,i,e){return t<i?i:t>e?e:t},TextureCache:{},BaseTextureCache:{}},x.TWEEN={easeBoth:function(t,i,e,s){return(t/=s/2)<1?e/2*t*t+i:-e/2*(--t*(t-2)-1)+i},extend:function(t){if(t)for(var i in t)"extend"!==i&&t[i]&&(this[i]=t[i])}},x.InteractionData=i,e.prototype.on=function(t,i){this.listeners[t]=this.listeners[t]||[],this.listeners[t].push(i)},e.prototype.off=function(t,i){if(this.listeners[t]){var e=this.listeners[t].length;if(i)for(;e--;)cbs[t][e]===i&&cbs[t].splice(e,1);else cbs[t].length=0}},e.prototype.emit=function(t){if(void 0!==this.listeners){var i=this.listeners,e=i[t.type];if(void 0!==e){var s,n=e.length;for(s=0;s<n;s++)e[s].call(this,t)}}},x.Eventer=e,x.Animate=s,s.prototype.nextPose=function(){var t={};for(var i in this.ATRE)t[i]=x.TWEEN[this.ease](this.progress,this.ATRS[i],this.ATRE[i]-this.ATRS[i],this.duration),void 0!==this.element[i]&&(this.element[i]=t[i]);return t},s.prototype.pause=function(){this.paused=!0},s.prototype.start=function(){this.paused=!1},s.prototype.stop=function(){this.progress=this.duration},s.prototype.cancle=function(){this.living=!1},x.Transition=n,n.prototype=Object.create(x.Animate.prototype),n.prototype.constructor=x.Transition,n.prototype.update=function(t){if(!this.paused&&this.living)if(this.progress+=this.timeScale*t,this.progress<this.duration){if(this.progress<0)return;var i=this.nextPose();this.onUpdate&&this.onUpdate(i,this.progress/this.duration)}else if(this.element.setVal(this.ATRE),this.onUpdate&&this.onUpdate(this.ATRE,1),this.repeats>0||this.infinity)if(this.repeats>0&&--this.repeats,this.progress=0,this.alternate){var e=x.copyJSON(this.ATRS);this.ATRS=x.copyJSON(this.ATRE),this.ATRE=e}else this.element.setVal(this.ATRS);else this.living=!1,this.onCompelete&&this.onCompelete()},x.Animation=o,o.prototype=Object.create(x.Animate.prototype),o.prototype.constructor=x.Animation,o.prototype.configKey=function(){this.ATRS=this._keyframes[this._keyIndex],this._keyIndex+=this._direction,this.ATRE=this._keyframes[this._keyIndex];var t=this._keyConfig[Math.min(this._keyIndex,this._keyIndex-this._direction)]||{};this.ease=t.ease||this.ease,this.duration=t.duration||this.duration,this.progress=0},o.prototype.update=function(t){if(!this.paused&&this.living)if(this.progress+=this.timeScale*t,this.progress<this.duration){if(this.progress<0)return;var i=this.nextPose();this.onUpdate&&this.onUpdate(i,this.progress/this.duration,this._keyIndex)}else this.element.setVal(this.ATRE),this.onUpdate&&this.onUpdate(this.ATRE,1,this._keyIndex),this._keyIndex<this._keyframes.length-1&&this._keyIndex>0?this.configKey():this.repeats>0||this.infinity?(this.repeats>0&&--this.repeats,this.alternate?this._direction*=-1:this._keyIndex=0,this.configKey()):(this.living=!1,this.onCompelete&&this.onCompelete())},x.MovieClip=r,r.prototype.update=function(t){if(!this.paused&&this.living&&(this.nt+=t,!(this.nt-this.pt<this.interval))){this.pt=this.nt;var i=this.index+this.direction;i<this.frames.length&&i>=0?this.index=i:this.repeats>0||this.infinity?(this.repeats>0&&--this.repeats,this.alternate?(this.direction*=-1,this.index+=this.direction):(this.direction=1,this.index=0)):(this.living=!1,this.index=this.fillMode,this.onCompelete&&this.onCompelete(),this.next&&this.next())}},r.prototype.getFramePos=function(){var t={x:this.sx,y:this.sy},i=this.frames[this.index];if(i>0){var e=this.element._textureW/this.element.width>>0,s=this.sx/this.element.width>>0,n=this.sy/this.element.height>>0,o=n+(s+i)/e>>0,r=(s+i)%e;t.x=r*this.element.width,t.y=o*this.element.height}return t},r.prototype.playMovie=function(t){this.next=null;var i=this.format(t.movie);x.isArray(i)&&(this.frames=i,this.index=0,this.direction=1,this.fillMode=t.fillMode||0,this.fps=t.fps||this.fps,this.infinity=t.infinity||!1,this.alternate=t.alternate||!1,this.repeats=t.repeats||0,this.living=!0,this.onCompelete=t.onCompelete||null)},r.prototype.format=function(t){if(x.isString(t)){var i=this.animations[t];return i?this.format(i):(console.warn("%c JC.MovieClip warn %c: you didn`t config %c"+t+"%c in animations ","color: #f98165; background: #80a89e","color: #80a89e; background: #cad9d5;","color: #f98165; background: #cad9d5","color: #80a89e; background: #cad9d5"),!1)}if(x.isArray(t))return t;if(x.isObject(t)){for(var e=[],s=t.start;s<=t.end;s++)e.push(s);if(t.next&&this.animations[t.next]){var n=this;this.next=function(){n.playMovie({movie:this.animations[t.next],infinity:!0})}}return e}},r.prototype.pause=function(){this.paused=!0},r.prototype.start=function(){this.paused=!1},r.prototype.cancle=function(){this.living=!1},Object.defineProperty(r.prototype,"interval",{get:function(){return this.fps>0?1e3/this.fps>>0:16}}),x.PathMotion=h,h.prototype=Object.create(x.Animate.prototype),h.prototype.constructor=x.PathMotion,h.prototype.update=function(t){if(!this.paused&&this.living)if(this.progress+=this.timeScale*t,this.progress<this.duration){if(this.progress<0)return;var i=this.nextPose();this.onUpdate&&this.onUpdate(i,this.progress/this.duration)}else if(this.element.setVal(this.ATRE),this.onUpdate&&this.onUpdate(this.ATRE,1),this.repeats>0||this.infinity)if(this.repeats>0&&--this.repeats,this.progress=0,this.alternate){var e=x.copyJSON(this.ATRS);this.ATRS=x.copyJSON(this.ATRE),this.ATRE=e}else this.element.setVal(this.ATRS);else this.living=!1,this.onCompelete&&this.onCompelete()},h.prototype.nextPose=function(){var t={},i=x.TWEEN[this.ease](this.progress,0,1,this.duration),e=this.getPoint(i,this.points);return t.x=e.x,t.y=e.y,this.attachNormal&&(t.rotate=this.decomposeRotate(i)),t},h.prototype.getPoint=function(t,i){var e=i,s=e.length,n=1-t,o=e.slice(0,s-1),r=e.slice(1),h={};if(s>3){var a=this.getPoint(t,o),p=this.getPoint(t,r);return h.x=n*a.x+t*p.x,h.y=n*a.y+t*p.y,h}return h.x=n*n*i[0].x+2*t*n*i[1].x+t*t*i[2].x,h.y=n*n*i[0].y+2*t*n*i[1].y+t*t*i[2].y,h},h.prototype.decomposeRotate=function(t){var i=this.getPoint(t,this.points),e=this.getPoint(t+.01,this.points);i.xxxxx+e.x},x.Animator=a,a.prototype.update=function(t){for(var i=0;i<this.animates.length;i++)this.animates[i].living||this.animates.splice(i,1),this.animates[i]&&this.animates[i].update(t)},a.prototype.fromTo=function(t){var i=new x.Transition(t);return this.animates.push(i),i},a.prototype.keyFrames=function(t){var i=new x.Animation(t);return this.animates.push(i),i},x.Point=p,p.prototype.constructor=x.Point,p.prototype.clone=function(){return new p(this.x,this.y)},p.prototype.copy=function(t){this.set(t.x,t.y)},p.prototype.equals=function(t){return t.x===this.x&&t.y===this.y},p.prototype.set=function(t,i){this.x=t||0,this.y=i||(0!==i?this.x:0)},x.Matrix=c,c.prototype.constructor=x.Matrix,c.prototype.fromArray=function(t){this.a=t[0],this.b=t[1],this.c=t[3],this.d=t[4],this.tx=t[2],this.ty=t[5]},c.prototype.toArray=function(t){this.array||(this.array=new x.Float32Array(9));var i=this.array;return t?(i[0]=this.a,i[1]=this.b,i[2]=0,i[3]=this.c,i[4]=this.d,i[5]=0,i[6]=this.tx,i[7]=this.ty,i[8]=1):(i[0]=this.a,i[1]=this.c,i[2]=this.tx,i[3]=this.b,i[4]=this.d,i[5]=this.ty,i[6]=0,i[7]=0,i[8]=1),i},c.prototype.apply=function(t,i){return i=i||{},i.x=this.a*t.x+this.c*t.y+this.tx,i.y=this.b*t.x+this.d*t.y+this.ty,i},c.prototype.applyInverse=function(t,i){var e=1/(this.a*this.d+this.c*-this.b);return i.x=this.d*e*t.x+-this.c*e*t.y+(this.ty*this.c-this.tx*this.d)*e,i.y=this.a*e*t.y+-this.b*e*t.x+(-this.ty*this.a+this.tx*this.b)*e,i},c.prototype.translate=function(t,i){return this.tx+=t,this.ty+=i,this},c.prototype.scale=function(t,i){return this.a*=t,this.d*=i,this.c*=t,this.b*=i,this.tx*=t,this.ty*=i,this},c.prototype.rotate=function(t){var i=Math.cos(t),e=Math.sin(t),s=this.a,n=this.c,o=this.tx;return this.a=s*i-this.b*e,this.b=s*e+this.b*i,this.c=n*i-this.d*e,this.d=n*e+this.d*i,this.tx=o*i-this.ty*e,this.ty=o*e+this.ty*i,this},c.prototype.append=function(t){var i=this.a,e=this.b,s=this.c,n=this.d;return this.a=t.a*i+t.b*s,this.b=t.a*e+t.b*n,this.c=t.c*i+t.d*s,this.d=t.c*e+t.d*n,this.tx=t.tx*i+t.ty*s+this.tx,this.ty=t.tx*e+t.ty*n+this.ty,this},c.prototype.identity=function(){return this.a=1,this.b=0,this.c=0,this.d=1,this.tx=0,this.ty=0,this},c.prototype.setTransform=function(t,i,e,s,n,o,r,h,a){var p,c,u,d,l,f,y,m,g,x;return l=Math.sin(r),f=Math.cos(r),y=Math.cos(a),m=Math.sin(a),g=-Math.sin(h),x=Math.cos(h),p=f*n,c=l*n,u=-l*o,d=f*o,this.a=y*p+m*u,this.b=y*c+m*d,this.c=g*p+x*u,this.d=g*c+x*d,this.tx=t+(e*p+s*u),this.ty=i+(e*c+s*d),this},x.IDENTITY=new c,x.TEMP_MATRIX=new c,x.BaseTextureCache={},u.prototype=Object.create(x.Eventer.prototype),u.prototype.constructor=u,u.prototype.update=function(){this.realWidth=this.source.naturalWidth||this.source.width,this.realHeight=this.source.naturalHeight||this.source.height,this.width=this.realWidth/this.resolution,this.height=this.realHeight/this.resolution,this.isPowerOfTwo=utils.isPowerOfTwo(this.realWidth,this.realHeight),this.emit({type:"update"})},u.prototype.loadSource=function(t){var i=this.isLoading;if(this.hasLoaded=!1,this.isLoading=!1,this.source=t,(this.source.complete||this.source.getContext)&&this.source.width&&this.source.height)this._sourceLoaded();else if(!t.getContext){this.isLoading=!0;var e=this;t.onload=function(){t.onload=null,t.onerror=null,e.isLoading=!1,e._sourceLoaded(),e.emit({type:"loaded"})},t.onerror=function(){t.onload=null,t.onerror=null,e.isLoading=!1,e.emit({type:"error"})},t.complete&&t.src&&(this.isLoading=!1,t.onload=null,t.onerror=null,t.width&&t.height?(this._sourceLoaded(),i&&this.emit({type:"loaded"})):i&&this.emit({type:"error"}))}},u.prototype._sourceLoaded=function(){this.hasLoaded=!0,this.update()},u.fromImage=function(t,i,e){var s=x.BaseTextureCache[t];if(void 0===i&&0!==t.indexOf("data:")&&(i=!0),!s){var n=new Image;i&&(n.crossOrigin=""),s=new u(n,e),s.imageUrl=t,n.src=t,x.BaseTextureCache[t]=s}return s},d.prototype=Object.create(x.Eventer.prototype),d.prototype.constructor=d,Object.defineProperties(d.prototype,{frame:{get:function(){return this._frame},set:function(t){this._frame=t,this.noFrame=!1,this.width=t.width,this.height=t.height,this.valid=t&&t.width&&t.height&&this.baseTexture.hasLoaded,this.valid&&this._updateUvs()}}}),d.prototype.update=function(){this.baseTexture.update()},d.prototype.onBaseTextureLoaded=function(t){this.noFrame?this.frame=new math.Rectangle(0,0,t.width,t.height):this.frame=this._frame,this.emit("update",this)},d.prototype.onBaseTextureUpdated=function(t){this._frame.width=t.width,this._frame.height=t.height,this.emit("update",this)},d.prototype._updateUvs=function(){this._uvs||(this._uvs=new l),this._uvs.set(this.frame,this.baseTexture)},d.fromImage=function(t,i,e){var s=x.UTILS.TextureCache[t];return s||(s=new d(u.fromImage(t,i,e)),x.UTILS.TextureCache[t]=s),s},d.fromCanvas=function(t,i){return new d(u.fromCanvas(t,i))},l.prototype.set=function(t,i){var e=i.width,s=i.height;this.x0=t.x/e,this.y0=t.y/s,this.x1=(t.x+t.width)/e,this.y1=t.y/s,this.x2=(t.x+t.width)/e,this.y2=(t.y+t.height)/s,this.x3=t.x/e,this.y3=(t.y+t.height)/s},x.DisplayObject=f,f.prototype.constructor=x.DisplayObject,Object.defineProperty(f.prototype,"scale",{get:function(){return this.scaleX},set:function(t){this.scaleX=this.scaleY=t}}),f.prototype.fromTo=function(t,i){return t.element=this,this.setVal(t.from),i&&(this.Animator.animates.length=0),this.Animator.fromTo(t)},f.prototype.to=function(t,i){t.element=this,t.from={};for(var e in t.to)t.from[e]=this[e];return i&&(this.Animator.animates.length=0),this.Animator.fromTo(t)},f.prototype.keyFrames=function(t,i){return t.element=this,i&&(this.Animator.animates.length=0),this.Animator.keyFrames(t)},f.prototype.isVisible=function(){return!!(this.visible&&this.alpha>0&&this.scaleX*this.scaleY>0)},f.prototype.setVal=function(t){if(void 0!==t)for(var i in t)void 0!==this[i]&&(this[i]=t[i])},f.prototype.updateMe=function(){var t,i,e,s,n,o,r=this.parent.worldTransform,h=this.worldTransform;this.skewX||this.skewY?(x.TEMP_MATRIX.setTransform(this.x,this.y,this.pivotX,this.pivotY,this.scaleX,this.scaleY,this.rotation,this.skewX,this.skewY),h.a=x.TEMP_MATRIX.a*r.a+x.TEMP_MATRIX.b*r.c,h.b=x.TEMP_MATRIX.a*r.b+x.TEMP_MATRIX.b*r.d,h.c=x.TEMP_MATRIX.c*r.a+x.TEMP_MATRIX.d*r.c,h.d=x.TEMP_MATRIX.c*r.b+x.TEMP_MATRIX.d*r.d,h.tx=x.TEMP_MATRIX.tx*r.a+x.TEMP_MATRIX.ty*r.c+r.tx,h.ty=x.TEMP_MATRIX.tx*r.b+x.TEMP_MATRIX.ty*r.d+r.ty):this.rotation%360?(this.rotation!==this.rotationCache&&(this.rotationCache=this.rotation,this._sr=Math.sin(this.rotation*x.DTR),this._cr=Math.cos(this.rotation*x.DTR)),t=this._cr*this.scaleX,i=this._sr*this.scaleX,e=-this._sr*this.scaleY,s=this._cr*this.scaleY,n=this.x,o=this.y,(this.pivotX||this.pivotY)&&(n-=this.pivotX*t+this.pivotY*e,o-=this.pivotX*i+this.pivotY*s),h.a=t*r.a+i*r.c,h.b=t*r.b+i*r.d,h.c=e*r.a+s*r.c,h.d=e*r.b+s*r.d,h.tx=n*r.a+o*r.c+r.tx,h.ty=n*r.b+o*r.d+r.ty):(t=this.scaleX,s=this.scaleY,n=this.x-this.pivotX*t,o=this.y-this.pivotY*s,h.a=t*r.a,h.b=t*r.b,h.c=s*r.c,h.d=s*r.d,h.tx=n*r.a+o*r.c+r.tx,h.ty=n*r.b+o*r.d+r.ty),this.worldAlpha=this.alpha*this.parent.worldAlpha},f.prototype.upAnimation=function(t){this.Animator.update(t)},f.prototype.setTransform=function(t){var i=this.worldTransform;t.globalAlpha=this.worldAlpha,t.setTransform(i.a,i.b,i.c,i.d,i.tx,i.ty)},f.prototype.getGlobalPos=function(){return{x:this.worldTransform.x,y:this.worldTransform.y}},f.prototype.on=function(t,i){this.event.on(t,i)},f.prototype.off=function(t,i){this.event.off(t,i)},f.prototype.once=function(t,i){var e=this,s=function(n){i&&i(n),e.event.off(t,s)};this.event.on(t,s)},f.prototype.getBound=function(){for(var t=[],i=this.bound.length>>1,e=0;e<i;e++){var s=this.worldTransform.apply({x:this.bound[2*e],y:this.bound[2*e+1]});t[2*e]=s.x,t[2*e+1]=s.y}return t},f.prototype.setBound=function(t,i){var e=this.bound.length;e>4&&i||(t=t||[-this.regX,this.regY,-this.regX,this.regY-this.height,-this.regX+this.width,this.regY-this.height,-this.regX+this.width,this.regY],this.bound=t)},f.prototype.ContainsPoint=function(t,i,e){for(var s,n=t.length>>1,o=t[2*n-3]-e,r=t[2*n-2]-i,h=t[2*n-1]-e,a=0;a<n;a++)s=r,o=h,r=t[2*a]-i,h=t[2*a+1]-e,o!=h&&(lup=h>o);var p=0;for(a=0;a<n;a++)if(s=r,o=h,r=t[2*a]-i,h=t[2*a+1]-e,!(o<0&&h<0||o>0&&h>0||s<0&&r<0)){if(o==h&&Math.min(s,r)<=0)return!0;if(o!=h){var c=s+(r-s)*-o/(h-o);if(0===c)return!0;c>0&&p++,0===o&&lup&&h>o&&p--,0===o&&!lup&&h<o&&p--,lup=h>o}}return 1==(1&p)},x.Container=y,y.prototype=Object.create(x.DisplayObject.prototype),y.prototype.constructor=x.Container,y.prototype.addChilds=function(t){if(void 0===t)return t;var i=arguments.length;if(i>1){for(var e=0;e<i;e++)this.addChilds(arguments[e]);return arguments[i-1]}return t.parent&&t.parent.removeChilds(t),t.parent=this,this.cds.push(t),t},y.prototype.removeChilds=function(){var t=arguments.length;if(t>1)for(var i=0;i<t;i++)this.removeChilds(arguments[i]);else if(1===t)for(var e=0;e<this.cds.length;e++)this.cds[e]===arguments[0]&&(this.cds.splice(e,1),this.cds[e].parent=null,e--)},y.prototype.updateTransform=function(t){this._ready&&(t=this.timeScale*t,!this.paused&&this.upAnimation(t),this.updateMe(),this.cds.length>0&&this.updateChilds(t))},y.prototype.updateChilds=function(t){for(var i=0,e=this.cds.length;i<e;i++){var s=this.cds[i];s.updateTransform(t)}},y.prototype.render=function(t){t.save(),this.setTransform(t),this.mask&&this.mask.render(t),this.renderMe(t),this.cds.length>0&&this.renderChilds(t),t.restore()},y.prototype.renderMe=function(){return!0},y.prototype.renderChilds=function(t){for(var i=0,e=this.cds.length;i<e;i++){var s=this.cds[i];s.isVisible()&&s._ready&&s.render(t)}},y.prototype.noticeEvent=function(t){for(var i=this.cds.length-1;i>=0;){var e=this.cds[i];if(e.visible&&(e.noticeEvent(t),t.target))break;i--}this.upEvent(t)},y.prototype.upEvent=function(t){if(this._ready&&(t.target||!this.passEvent&&this.hitTest(t))&&(!t.cancleBubble||t.target===this)){if(!(this.event.listeners[t.type]&&this.event.listeners[t.type].length>0))return;this.event.emit(t)}},y.prototype.hitTest=function(t){if("touchmove"===t.type||"touchend"===t.type||"mousemove"===t.type||"mouseup"===t.type){var i=this.event.touchstarted;return i&&(t.target=this),"touchend"!==t.type&&"mouseup"!==t.type||(this.event.touchstarted=!1),i}return!!this.hitTestMe(t)&&(t.target=this,"touchstart"!==t.type&&"mousedown"!==t.type||(this.event.touchstarted=!0),!0)},y.prototype.hitTestMe=function(t){return this.ContainsPoint(this.getBound(),t.global.x,t.global.y)},y.prototype.pause=function(){this.paused=!0},y.prototype.start=function(){this.paused=!1},y.prototype.cancle=function(){this.Animator.animates.length=0},x.Sprite=m,m.prototype=Object.create(x.Container.prototype),m.prototype.constructor=x.Sprite,Object.defineProperties(m.prototype,{width:{get:function(){return Math.abs(this.scale.x)*this.texture._frame.width},set:function(t){var i=utils.sign(this.scale.x)||1;this.scale.x=i*t/this.texture._frame.width,this._width=t}},height:{get:function(){return Math.abs(this.scale.y)*this.texture._frame.height},set:function(t){var i=utils.sign(this.scale.y)||1;this.scale.y=i*t/this.texture._frame.height,this._height=t}},texture:{get:function(){return this._texture},set:function(t){this._texture!==t&&(this._texture=t,this.cachedTint=16777215,t&&(t.baseTexture.hasLoaded?this._onTextureUpdate():t.once("update",this._onTextureUpdate,this)))}}}),m.prototype.upTexture=function(){this._textureW=opts.texture.width,this._textureH=opts.texture.height,this.width=opts.width||this._textureW,this.height=opts.height||this._textureH,this.regX=this.width>>1,this.regY=this.height>>1,this.setBound(null,!0)},m.prototype.render=function(t){t.setObjectRenderer(t.plugins.sprite),t.plugins.sprite.render(this)},m.prototype.getBounds=function(t){},m.prototype.getLocalBounds=function(){},m.prototype.containsPoint=function(t){},x.ParticleContainer=g,g.prototype=Object.create(x.Container.prototype),g.prototype.constructor=x.ParticleContainer,g.prototype.setProperties=function(t){t&&(this._properties[0]="scale"in t?!!t.scale:this._properties[0],this._properties[1]="position"in t?!!t.position:this._properties[1],this._properties[2]="rotation"in t?!!t.rotation:this._properties[2],this._properties[3]="uvs"in t?!!t.uvs:this._properties[3],this._properties[4]="alpha"in t?!!t.alpha:this._properties[4])},g.prototype.updateTransform=function(){this.displayObjectUpdateTransform()},g.prototype.render=function(t){this.visible&&!(this.worldAlpha<=0)&&this.children.length&&this.renderable&&(t.setObjectRenderer(t.plugins.particle),t.plugins.particle.render(this))},x});
//# sourceMappingURL=../maps/jcw2d.js.map
